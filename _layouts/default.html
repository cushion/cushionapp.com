<!DOCTYPE html>
<html>
  <head>
    <meta content='text/html; charset=utf-8' http-equiv='Content-Type'>
    <meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>

    <title>{{ site.title }}</title>

    <meta name='description' content='{{ site.meta.description }}'>
    <meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1.0'>

    <link rel='icon' type='image/png' href='/assets/images/favicon.png'>
    <link rel='shortcut icon' type='image/png' href='/assets/images/favicon.png'>

    <link href='/assets/styles/screen.css' rel='stylesheet'>

    {% include 'includes/fonts' %}
    {% include 'includes/analytics' %}
  </head>

  <body>
    <div class='wrapper outer-container'>
      <div class='inner-container'>
        <header class='main-header'>
          <h1 class='logo'>{{ site.title }}</h1>
          <h2 class='tagline'>{{ site.meta.tagline }}</h2>
        </header>

        {{ content }}

        <footer class='main-footer'>
          Follow <a class='link' href='http://twitter.com/{{ site.meta.twitter }}'>@{{ site.meta.twitter }}</a> on Twitter
        </footer>
      </div>
    </div>

    <script src='/assets/scripts/libs/husl.min.js'></script>
    <script>
      window.addEventListener('load', function(e) {
        var isLoaded;
        var stylesheet = document.styleSheets[0];
        var rules = stylesheet.rules || stylesheet.cssRules;
        var numRules = rules.length;
        var direction = 1;
        var minHue = 100;
        var maxHue = 250;
        var hue = minHue + Math.random() * (maxHue - minHue);
        var hex;

        var addCSSRule = function(selector, rule) {
          if (stylesheet.addRule) {
            stylesheet.addRule(selector, rule);
          } else if (stylesheet.insertRule) {
            rule = selector.concat(" { ", rule, " }");
            stylesheet.insertRule(rule, rules.length);
          }
        };

        var addMozCSSRule = function(selector, rule) {
          if (stylesheet.insertRule && !stylesheet.addRule) {
            rule = selector.concat(" { ", rule, " }");
            stylesheet.insertRule(rule, rules.length);
          }
        };

        var addWebkitCSSRule = function(selector, rule) {
          if (stylesheet.addRule) {
            stylesheet.addRule(selector, rule);
          }
        };

        var removeCSSRule = function(index) {
          if (stylesheet.deleteRule) {
            stylesheet.deleteRule(index);
          } else if (stylesheet.removeRule) {
            stylesheet.removeRule(index);
          }
        };

        setInterval(function () {
          hue += 0.5 * direction;
          hex = window.HUSL.toHex(hue, 70, 60)
          if (hue < minHue || hue > maxHue) direction *= -1;

          while (rules.length > numRules) removeCSSRule(rules.length - 1);

          addCSSRule('.link', "color: " + hex);
          addCSSRule('.button', "background-color: " + hex);
          addCSSRule('.article a', "border-bottom-color: " + hex);
          addWebkitCSSRule('::selection', "background-color: " + hex);
          addMozCSSRule('::-moz-selection', "background-color: " + hex);
        }, 1000/5);
      },false);
    </script>
  </body>
</html>
